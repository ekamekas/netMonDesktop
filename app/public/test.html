<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Test Pengelompokan</title>
    <script type="text/javascript" src="../js/dataStatistic.js">
    </script>
    <script type="text/javascript" src="../js/utility.js">
    </script>
  </head>
  <body>
    <p><a href="../../index.html">Home</a></p>
    <script type="text/javascript">
    var trafficData = []
    var sortedData = []
    var peaks = []
    var clusters = []
    var sortedPeaks = []
    var clustersOfPeaks = []

    new Utility().getXML("https://123.231.138.149/api/historicdata.xml?id=2180&sdate=2017-06-01-00-00-00&edate=2017-06-30-00-00-00&username=nsc_admin&avg=3600&passhash=4041964660", function(result){

      trafficData = []
      for(let i = 1; i < result.histdata.item.length; i++){
        trafficData.push(parseInt(result.histdata.item[i].value_raw[1]._/125))
      }
      peaks = findPeaks(trafficData)
      sortedData = new DataStatistic().sortedData(trafficData)
      sortedPeaks = new DataStatistic().sortedData(peaks)

      let widthClass = Math.ceil((sortedData[sortedData.length - 1] - sortedData[0])/(1 + 3.3 * Math.log(sortedData.length)))
      clusters = new DataCluster(sortedData, widthClass)
      clusterOfPeaks = new DataCluster(sortedPeaks, Math.ceil((sortedPeaks[sortedPeaks.length - 1] - sortedData[0])/(1 + 3.3 * Math.log(sortedPeaks.length))))

    })

    var findPeaks = (array) => {
      let peaks = []
      for(let i = 0; i < array.length; i++){
        if(array[i] > array[i + 1])
          peaks.push(array[i])
      }
      return peaks
    }
    </script>
  </body>
</html>
